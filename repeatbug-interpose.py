#!/usr/bin/env python

import subprocess, sys

print_flag = True
if len(sys.argv) > 1 and sys.argv[1] == 'silent':
	print_flag = False

libsafecount=0
for i in range(1000):
	try:
		subprocess.check_output('./bug-interpose.sh', stderr=subprocess.STDOUT)
	except subprocess.CalledProcessError as e:
		if e.output.split()[0] == 'Libsafe':
			if print_flag: print e.output
			libsafecount += 1
print str(libsafecount) + ' out of 1000 exploit attempts were caught by libsafe.'
